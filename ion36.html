<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Interactive Ion and Compound Formation</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 0;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            min-height: 100vh;
            background-color: #f4f4f4;
        }

        #quark-info-${ionId} {
            margin-top: 10px;
            font-size: 14px;
            color: #333;
        }

        .decaying-indicator {
            margin-top: 10px;
            padding: 5px 10px;
            font-weight: bold;
            border-radius: 5px;
            animation: flash 1s infinite alternate;  /* Flashing effect */
            visibility: hidden; /* Initially hidden */
        }


        .hidden {
            display: none;
        }

        @keyframes flash {
            0% { opacity: 1; background-color: transparent; }
            100% { opacity: 0.1; background-color: transparent; }
        }


        .ion-container {
            display: flex;
            align-items: center;
            margin-bottom: 20px;
            border: 1px solid #ddd;
            padding: 15px;
            border-radius: 10px;
            background-color: #fff;
            width: 800px;
            justify-content: space-between;
            position: relative;
            overflow: hidden;
        }

        .ion-animation {
            text-align: center;
            position: relative;
            width: 300px;
            height: 300px;
            display: flex;
            justify-content: center;
            align-items: center;
            perspective: 1000px;
            transform-style: preserve-3d;
        }

        .nucleus {
            width: 100px;
            height: 100px;
            background-color: yellow;
            border-radius: 50%;
            position: relative;
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 2;
        }

        .electron {
            width: 7px;
            height: 7px;
            border-radius: 50%;
            position: absolute;
            background-color: blue;
            animation: orbit linear infinite;
            transform-origin: center;
        }

        .proton {
            background-color: red;
            width: 8.5px;
            height: 8.5px;
            border-radius: 50%;
            position: absolute;
            animation: subtleOscillation 3s infinite;
        }

        .neutron {
            background-color: green;
            width: 9.5px;
            height: 9.5px;
            border-radius: 50%;
            position: absolute;
            animation: subtleOscillation 3s infinite;
        }

        @keyframes subtleOscillation {
            0% { transform: translate(0, 0); }
            50% { transform: translate(3px, 3px); }
            100% { transform: translate(0, 0); }
        }

        @keyframes orbit {
            0% {
                transform: rotateZ(0deg) translateX(var(--orbit-radius)) rotateZ(0deg);
            }
            100% {
                transform: rotateZ(360deg) translateX(var(--orbit-radius)) rotateZ(-360deg);
            }
        }

        @keyframes orbit3D {
            0% {
                transform: rotateX(0deg) rotateY(0deg) translateZ(var(--orbit-radius));
            }
            100% {
                transform: rotateX(360deg) rotateY(360deg) translateZ(var(--orbit-radius));
            }
        }

        #periodic-table {
            display: grid;
            grid-template-columns: repeat(18, 1fr);
            grid-gap: 5px;
            margin-top: 50px;
            width: 80%;
            overflow-y: scroll;
        }

        .element {
            background-color: #ddd;
            text-align: center;
            padding: 10px;
            border-radius: 4px;
            cursor: pointer;
        }

        .controls {
            margin-top: 20px;
        }

        button {
            margin: 5px;
            padding: 10px;
            background-color: #4CAF50;
            color: white;
            border: none;
            cursor: pointer;
            border-radius: 5px;
        }

        button:hover {
            background-color: #45a049;
        }
    </style>
</head>
<body>

<h2>Interactive Ion System with Compound Formation</h2>

<div class="controls">
    <button id="add-ion-button">Add New Ion</button>
    <button id="form-compound-button">Form Compound</button>
</div>

<div id="ions-container"></div>

<div id="periodic-table"></div>

<script>
let ions = [];
let selectedIonId = null;
let decayIntervals = {};

function startDecay(ionId) {
    const ion = ions[ionId];
    const decayIndicator = document.getElementById(`decaying-indicator-${ionId}`);
    const yearsDecayedElement = document.getElementById(`years-decayed-${ionId}`);

    // Reset the total years decayed only when starting a new decay process
    if (!decayIntervals[ionId]) {
        ion.totalYearsDecayed = 0;  // Reset when starting decay
        yearsDecayedElement.innerText = ion.totalYearsDecayed;
    }

    if (decayIntervals[ionId]) {
        alert("Decay already running for this ion.");
        return;
    }

    // Make the "Decaying..." indicator visible
    decayIndicator.style.visibility = 'visible';

    decayIntervals[ionId] = setInterval(() => {
        // Increment the total years decayed and update the display
        ion.totalYearsDecayed++;
    yearsDecayedElement.innerText = ion.totalYearsDecayed; // Update the display with the new value

    // Simulate decay by removing protons and neutrons
    if (ion.protons > 0) ion.protons--;
    if (ion.neutrons > 0) ion.neutrons--;
    updateIonInfo(ionId);

    if (ion.protons === 0 && ion.neutrons === 0) {
        clearInterval(decayIntervals[ionId]);
        delete decayIntervals[ionId];
        alert(`Ion ${ionId + 1} has fully decayed.`);
        decayIndicator.style.visibility = 'hidden';  // Hide the indicator when fully decayed
    }
}, ion.decayRate);  // Interval uses the decay rate for timing
}




function stopDecay(ionId) {
    const decayIndicator = document.getElementById(`decaying-indicator-${ionId}`);

    if (decayIntervals[ionId]) {
        clearInterval(decayIntervals[ionId]);
        delete decayIntervals[ionId];

        // Hide the "Decaying..." indicator when decay is stopped
        decayIndicator.style.visibility = 'hidden';
    } else {
        alert("Decay is not running for this ion.");
    }
}



function changeDecayRate(ionId, newRate) {
    ions[ionId].decayRate = parseInt(newRate);
}

document.addEventListener("DOMContentLoaded", function () {
    document.getElementById("add-ion-button").addEventListener("click", createNewIon);
    document.getElementById("form-compound-button").addEventListener("click", formCompound);
    generatePeriodicTable();
});

function getElectronConfiguration(protons) {
    const shells = [2, 8, 18, 32]; // Shell capacity
    let electrons = protons;
    let config = [];
    for (let i = 0; i < shells.length; i++) {
        const electronsInShell = Math.min(electrons, shells[i]);
        config.push(electronsInShell);
        electrons -= electronsInShell;
        if (electrons === 0) break;
    }
    return config.join(', ');
}

function updateQuarkInfo(ionId) {
    const ion = ions[ionId];

    // Count the number of proton and neutron quarks
    const protonCount = ion.quarks.protons.length;
    const neutronCount = ion.quarks.neutrons.length;

    // Abbreviated display for protons and neutrons quarks
    const protonQuarksAbbreviated = `${protonCount}x(up-up-down)`;
    const neutronQuarksAbbreviated = `${neutronCount}x(down-down-up)`;

    // Update the quark info in the HTML
    document.getElementById(`quark-info-${ionId}`).innerHTML = `
<p>Protons Quarks: ${protonQuarksAbbreviated}</p>
            <p>Neutrons Quarks: ${neutronQuarksAbbreviated}</p>
    `;
}


function addElectron(ionId) {
    ions[ionId].electrons++;
    ions[ionId].charge--;
    updateQuarkInfo(ionId);
    updateIonInfo(ionId); // Ensure the info and visualization are updated
}

function removeElectron(ionId) {
    if (ions[ionId].electrons > 0) {
        ions[ionId].electrons--;
        ions[ionId].charge++;
        updateQuarkInfo(ionId);
        updateIonInfo(ionId); // Ensure the info and visualization are updated
    }
}

function addProton(ionId) {
    ions[ionId].protons++;
    ions[ionId].charge++;
    ions[ionId].quarks.protons.push(['up', 'up', 'down']);  // Correctly add a proton's quarks
    updateIonInfo(ionId);
    updateQuarkInfo(ionId);
}

function removeProton(ionId) {
    if (ions[ionId].protons > 0) {
        ions[ionId].protons--;
        ions[ionId].charge--;
        ions[ionId].quarks.protons.pop();  // Remove a proton's quark structure
        updateIonInfo(ionId);
        updateQuarkInfo(ionId);
    }
}

function addNeutron(ionId) {
    ions[ionId].neutrons++;
    ions[ionId].quarks.neutrons.push(['down', 'down', 'up']);  // Add neutron quarks
    updateIonInfo(ionId);
    updateQuarkInfo(ionId);
}

function removeNeutron(ionId) {
    if (ions[ionId].neutrons > 0) {
        ions[ionId].neutrons--;
        ions[ionId].quarks.neutrons.pop();  // Remove a neutron's quark structure
        updateIonInfo(ionId);
        updateQuarkInfo(ionId);
    }
}



function neutronDecay(ionId) {
    const ion = ions[ionId];
    if (ion.neutrons > 0) {
        ion.neutrons--;
        ion.protons++;
        ion.quarks.neutrons.pop();  // Remove a neutron
        ion.quarks.protons.push(['up', 'up', 'down']);  // Add a proton

        updateIonInfo(ionId);
        updateQuarkInfo(ionId);
    }
}

// Function to select an ion when a radio button is clicked
function selectIon(ionId) {
    selectedIonId = ionId;
}

function updateQuarkInfo(ionId) {
    const ion = ions[ionId];

    // Count the number of protons and neutrons quarks
    const protonCount = ion.quarks.protons.length;
    const neutronCount = ion.quarks.neutrons.length;

    // Abbreviated display for protons and neutrons quarks
    const protonQuarksAbbreviated = `${protonCount}x(up-up-down)`;
    const neutronQuarksAbbreviated = `${neutronCount}x(down-down-up)`;

    // Update the quark info in the HTML for the specific ion
    const quarkInfoElement = document.getElementById(`quark-info-${ionId}`);
    if (quarkInfoElement) {
        quarkInfoElement.innerHTML = `
    <p>Protons Quarks: ${protonQuarksAbbreviated}</p>
                <p>Neutrons Quarks: ${neutronQuarksAbbreviated}</p>
        `;
    }
}

function startDecay(ionId) {
    const ion = ions[ionId];
    const decayIndicator = document.getElementById(`decaying-indicator-${ionId}`);
    const yearsDecayedElement = document.getElementById(`years-decayed-${ionId}`); // Get the unique element

    if (decayIntervals[ionId]) {
        alert("Decay already running for this ion.");
        return;
    }

    // Reset totalYearsDecayed only when decay starts
    ion.totalYearsDecayed = 0;
    yearsDecayedElement.innerText = ion.totalYearsDecayed; // Reset display

    // Make the "Decaying..." indicator visible
    decayIndicator.style.visibility = 'visible';

    decayIntervals[ionId] = setInterval(() => {
        // Increment the total years decayed and update the display
        ion.totalYearsDecayed++;
    yearsDecayedElement.innerText = ion.totalYearsDecayed; // Update the display with the new value

    // Simulate decay by removing protons and neutrons
    if (ion.protons > 0) ion.protons--;
    if (ion.neutrons > 0) ion.neutrons--;
    updateIonInfo(ionId);

    if (ion.protons === 0 && ion.neutrons === 0) {
        clearInterval(decayIntervals[ionId]);
        delete decayIntervals[ionId];
        alert(`Ion ${ionId + 1} has fully decayed.`);
        decayIndicator.style.visibility = 'hidden';  // Hide the indicator when fully decayed
    }
}, ion.decayRate);
}


function stopDecay(ionId) {
    const decayIndicator = document.getElementById(`decaying-indicator-${ionId}`);

    if (decayIntervals[ionId]) {
        clearInterval(decayIntervals[ionId]);
        delete decayIntervals[ionId];

        // Hide the "Decaying..." indicator when decay is stopped
        decayIndicator.style.visibility = 'hidden';
    } else {
        alert("Decay is not running for this ion.");
    }
}

function createNewIon() {
    const ionId = ions.length;
    const newIon = {
        id: ionId,
        protons: 1,
        neutrons: 0,
        electrons: 1,
        charge: 0,
        elementName: 'Hydrogen',
        elementFamily: 'Nonmetal',
        quarks: {
            protons: [['up', 'up', 'down']],
            neutrons: []
        },
        decayRate: 5000, // Default decay rate (5 seconds = 1 year)
        totalYearsDecayed: 0 // Track years decayed
    };
    ions.push(newIon);

    const ionContainer = document.createElement('div');
    ionContainer.className = 'ion-container';
    ionContainer.id = `ion-${ionId}`;
    ionContainer.innerHTML = `
<div>
    <input type="checkbox" id="compound-checkbox-${ionId}">
            <label for="compound-checkbox-${ionId}">Add to Compound Mix</label>
            <h3><input type="radio" name="selected-ion" onclick="selectIon(${ionId})" value="${ionId}"> Ion ${ionId + 1}</h3>
            <div id="ion-animation-${ionId}" class="ion-animation">
            <div class="nucleus" id="nucleus-${ionId}"></div>
            </div>
            <div id="decaying-indicator-${ionId}" class="decaying-indicator">Decaying...</div> <!-- Decaying Indicator -->
            <p>Total Years Decayed: <span id="years-decayed-${ionId}">0</span></p>
            </div>
            <div>
    <div class="controls">
            <button onclick="addElectron(${ionId})">Add Electron</button>
    <button onclick="removeElectron(${ionId})">Remove Electron</button>
    <button onclick="addProton(${ionId})">Add Proton</button>
    <button onclick="removeProton(${ionId})">Remove Proton</button>
    <button onclick="addNeutron(${ionId})">Add Neutron</button>
    <button onclick="removeNeutron(${ionId})">Remove Neutron</button>
    <button onclick="startDecay(${ionId})">Start Decay</button>
    <button onclick="stopDecay(${ionId})">Stop Decay</button>
            </div>
    <div id="ion-info-${ionId}">
            <p>Element: <span id="element-name-${ionId}">${newIon.elementName}</span></p>
            <p>Family: <span id="element-family-${ionId}">${newIon.elementFamily}</span></p>
            <p>Protons: <span id="proton-count-${ionId}">1</span></p>
            <p>Neutrons: <span id="neutron-count-${ionId}">0</span></p>
            <p>Electrons: <span id="electron-count-${ionId}">1</span></p>
            <p>Charge: <span id="charge-${ionId}">0</span></p>
            </div>
    <div id="quark-info-${ionId}">
            <p>Protons Quarks: up-up-down</p>
            <p>Neutrons Quarks: up-down-down</p>
            </div>
    <label for="decay-rate-${ionId}">Decay Speed (ms/year): </label>
    <input type="range" id="decay-rate-${ionId}" min="100" max="10000" value="5000" step="100" oninput="updateDecayRateFeedback(${ionId}, this.value)">
            <span id="decay-rate-value-${ionId}">5000 ms/year</span>
    </div>
    `;
    document.getElementById('ions-container').appendChild(ionContainer);
    updateIonInfo(ionId);
    updateQuarkInfo(ionId);  // Initialize quark information
}

function updateDecayRateFeedback(ionId, newRate) {
    // Update the displayed decay rate value
    document.getElementById(`decay-rate-value-${ionId}`).innerText = `${newRate} ms/year`;

    // Also update the actual decay rate in the ion data
    changeDecayRate(ionId, newRate);
}



function updateIonInfo(ionId) {
    const ion = ions[ionId];

    const protonElement = document.getElementById(`proton-count-${ionId}`);
    if (protonElement) protonElement.innerText = ion.protons;

    const neutronElement = document.getElementById(`neutron-count-${ionId}`);
    if (neutronElement) neutronElement.innerText = ion.neutrons;

    const electronElement = document.getElementById(`electron-count-${ionId}`);
    if (electronElement) electronElement.innerText = ion.electrons;

    const chargeElement = document.getElementById(`charge-${ionId}`);
    if (chargeElement) chargeElement.innerText = ion.charge;

    const nucleus = document.getElementById(`nucleus-${ionId}`);
    if (nucleus) {
        if (ion.charge === 0) {
            nucleus.style.backgroundColor = 'yellow';
        } else if (ion.charge > 0) {
            nucleus.style.backgroundColor = 'orange';
        } else {
            nucleus.style.backgroundColor = 'purple';
        }
    }

    const elementNameElement = document.getElementById(`element-name-${ionId}`);
    const elementFamilyElement = document.getElementById(`element-family-${ionId}`);
    if (elementNameElement && elementFamilyElement) {
        const foundElement = elements.find(el => el.number === ion.protons);
        if (foundElement) {
            ion.elementName = foundElement.name;
            ion.elementFamily = foundElement.family;
            elementNameElement.innerText = ion.elementName;
            elementFamilyElement.innerText = ion.elementFamily;
        } else {
            ion.elementName = 'Unknown';
            ion.elementFamily = 'Unknown';
            elementNameElement.innerText = ion.elementName;
            elementFamilyElement.innerText = ion.elementFamily;
        }
    }

    // Update Electron Configuration
    const electronConfigElement = document.getElementById(`electron-config-${ionId}`);
    if (electronConfigElement) {
        const electronConfig = getElectronConfiguration(ion.protons);
        electronConfigElement.innerText = electronConfig;
    }

    updateAnimation(ionId);
}


function updateAnimation(ionId) {
    const ion = ions[ionId];
    const nucleus = document.getElementById(`nucleus-${ionId}`);
    nucleus.innerHTML = ''; // Clear previous protons and neutrons

    const numProtons = ion.protons;
    const numNeutrons = ion.neutrons;
    const radius = 40; // Adjust this value for the size of the nucleus

    // Distribute protons and neutrons randomly inside the nucleus
    for (let i = 0; i < numProtons; i++) {
        const proton = document.createElement('div');
        proton.className = 'proton';
        const position = getRandomPositionInCircle(radius);
        proton.style.position = 'absolute';
        proton.style.top = `${position.y + radius}px`;
        proton.style.left = `${position.x + radius}px`;
        nucleus.appendChild(proton);
    }

    for (let i = 0; i < numNeutrons; i++) {
        const neutron = document.createElement('div');
        neutron.className = 'neutron';
        const position = getRandomPositionInCircle(radius);
        neutron.style.position = 'absolute';
        neutron.style.top = `${position.y + radius}px`;
        neutron.style.left = `${position.x + radius}px`;
        nucleus.appendChild(neutron);
    }

    // Ensure electrons are added properly
    const animation = document.getElementById(`ion-animation-${ionId}`);
    animation.querySelectorAll('.electron').forEach(electron => electron.remove());

    // Add electrons orbiting in 3D around the nucleus
    const shellDistances = [60, 90, 120]; // Distances of electron shells from the nucleus
    let electronsPerShell = [2, 8, 18]; // Max electrons per shell
    let totalElectrons = ion.electrons;

    for (let shell = 0; shell < shellDistances.length && totalElectrons > 0; shell++) {
        const electronsInThisShell = Math.min(totalElectrons, electronsPerShell[shell]);

        for (let i = 0; i < electronsInThisShell; i++) {
            const electron = document.createElement('div');
            electron.className = 'electron';
            electron.style.setProperty('--orbit-radius', `${shellDistances[shell]}px`);
            electron.style.animation = `orbit3D ${Math.random() * 4 + 3}s linear infinite`;
            electron.style.animationDelay = `${Math.random()}s`;

            animation.appendChild(electron);
        }
        totalElectrons -= electronsInThisShell;
    }
}

function getRandomPositionInCircle(radius) {
    const angle = Math.random() * 2 * Math.PI;
    const distance = Math.sqrt(Math.random()) * radius; // Ensures uniform distribution
    const x = Math.cos(angle) * distance;
    const y = Math.sin(angle) * distance;
    return { x, y };
}

const incompatibleFamilies = {
    'Noble Gas + Alkali Metal': 'Noble gases are inert and do not react with alkali metals.',
    'Noble Gas + Alkaline Earth Metal': 'Noble gases are inert and do not react with alkaline earth metals.',
    'Noble Gas + Transition Metal': 'Noble gases are inert and do not react with transition metals.',
    'Noble Gas + Post-Transition Metal': 'Noble gases are inert and do not react with post-transition metals.',
    'Noble Gas + Metalloid': 'Noble gases are inert and do not react with metalloids.',
    'Noble Gas + Nonmetal': 'Noble gases are inert and do not react with nonmetals.',
    'Noble Gas + Lanthanide': 'Noble gases are inert and do not react with lanthanides.',
    'Noble Gas + Actinide': 'Noble gases are inert and do not react with actinides.',
    'Noble Gas + Noble Gas': 'Noble gases are inert and do not form compounds with each other.',

    'Alkali Metal + Alkali Metal': 'Alkali metals are too reactive to combine with each other.',
    'Alkali Metal + Transition Metal': 'Alkali metals are too reactive to combine with transition metals.',
    'Alkali Metal + Post-Transition Metal': 'Alkali metals are too reactive to combine with post-transition metals.',
    'Alkali Metal + Lanthanide': 'Alkali metals do not combine with lanthanides.',
    'Alkali Metal + Actinide': 'Alkali metals do not combine with actinides.',

    'Alkaline Earth Metal + Alkaline Earth Metal': 'Alkaline earth metals form compounds with nonmetals, not with each other.',
    'Alkaline Earth Metal + Transition Metal': 'Alkaline earth metals do not typically form compounds with transition metals.',
    'Alkaline Earth Metal + Post-Transition Metal': 'Alkaline earth metals do not typically form compounds with post-transition metals.',
    'Alkaline Earth Metal + Lanthanide': 'Alkaline earth metals do not combine with lanthanides.',
    'Alkaline Earth Metal + Actinide': 'Alkaline earth metals do not combine with actinides.',

    'Transition Metal + Transition Metal': 'Transition metals typically do not form simple compounds with each other.',
    'Transition Metal + Post-Transition Metal': 'Transition metals do not usually combine with post-transition metals.',
    'Transition Metal + Lanthanide': 'Transition metals do not form simple compounds with lanthanides.',
    'Transition Metal + Actinide': 'Transition metals do not form simple compounds with actinides.',

    'Post-Transition Metal + Post-Transition Metal': 'Post-transition metals do not typically form compounds with each other.',
    'Post-Transition Metal + Lanthanide': 'Post-transition metals do not combine with lanthanides.',
    'Post-Transition Metal + Actinide': 'Post-transition metals do not combine with actinides.',

    'Metalloid + Metalloid': 'Metalloids do not typically form compounds with each other.',
    'Metalloid + Lanthanide': 'Metalloids do not combine with lanthanides.',
    'Metalloid + Actinide': 'Metalloids do not combine with actinides.',

    'Halogen + Halogen': 'Halogens tend to combine with metals rather than each other in simple compounds.',
    'Halogen + Lanthanide': 'Halogens do not typically combine with lanthanides.',
    'Halogen + Actinide': 'Halogens do not typically combine with actinides.',

    'Lanthanide + Lanthanide': 'Lanthanides do not typically combine with each other.',
    'Lanthanide + Actinide': 'Lanthanides do not typically combine with actinides.',

    'Actinide + Actinide': 'Actinides do not typically combine with each other.',
};


// Define more detailed compatible families, including cases where same-family combinations are allowed (e.g., H2)
const compatibleFamilies = {
    'Nonmetal': ['Alkali Metal', 'Halogen', 'Noble Gas', 'Alkaline Earth Metal', 'Nonmetal'], // Allow Nonmetal + Nonmetal (e.g., H2)
    'Alkali Metal': ['Nonmetal', 'Halogen', 'Alkaline Earth Metal', 'Alkali Metal'], // Allow Alkali Metal + Alkali Metal
    'Halogen': ['Nonmetal', 'Alkali Metal', 'Alkaline Earth Metal', 'Halogen'], // Allow Halogen + Halogen
    'Alkaline Earth Metal': ['Nonmetal', 'Halogen', 'Alkali Metal', 'Alkaline Earth Metal'], // Allow Alkaline Earth Metal + Alkaline Earth Metal
    'Noble Gas': [], // Noble gases do not react with other families
    'Transition Metal': ['Nonmetal', 'Halogen', 'Post-Transition Metal', 'Transition Metal'], // Allow Transition Metal + Transition Metal
    'Post-Transition Metal': ['Nonmetal', 'Halogen', 'Transition Metal', 'Post-Transition Metal'], // Allow Post-Transition Metal + Post-Transition Metal
    'Metalloid': ['Nonmetal', 'Halogen', 'Transition Metal', 'Metalloid'], // Allow Metalloid + Metalloid
    'Lanthanide': ['Nonmetal', 'Halogen', 'Lanthanide'], // Allow Lanthanide + Lanthanide
    'Actinide': ['Nonmetal', 'Halogen', 'Actinide'] // Allow Actinide + Actinide
};

// Updated Compatibility Matrix with More Specific Combinations
const compatibilityMatrix = {
    'Nonmetal': ['Alkali Metal', 'Halogen', 'Nonmetal'],  // Nonmetals combine with Alkali Metals, Halogens, and other Nonmetals (e.g., H2, O2)
    'Alkali Metal': ['Nonmetal', 'Halogen'],  // Alkali Metals combine with Nonmetals and Halogens
    'Halogen': ['Nonmetal', 'Alkali Metal', 'Metalloid'],  // Halogens combine with Nonmetals, Alkali Metals, and Metalloids
    'Alkaline Earth Metal': ['Nonmetal', 'Halogen'],  // Alkaline Earth Metals combine with Nonmetals and Halogens
    'Noble Gas': [],  // Noble Gases are inert and don't combine with anything
    'Transition Metal': ['Nonmetal', 'Halogen'],  // Transition Metals combine mainly with Nonmetals and Halogens
    'Post-Transition Metal': ['Nonmetal', 'Halogen'],  // Post-Transition Metals with Nonmetals and Halogens
    'Metalloid': ['Nonmetal', 'Halogen'],  // Metalloids with Nonmetals and Halogens
    'Lanthanide': ['Nonmetal'],  // Lanthanides with Nonmetals
    'Actinide': ['Nonmetal'],  // Actinides with Nonmetals
};

// Function to check if two elements are compatible based on their families
function checkCompatibility(element1, element2) {
    console.log('Checking compatibility between:', element1, element2);

    // Check if either element is undefined
    if (!element1 || !element2) {
        return `One or both elements are undefined.`;
    }

    const family1 = element1.elementFamily;
    const family2 = element2.elementFamily;

    // Check if element names or families are undefined
    if (!element1.elementName || !element2.elementName || !family1 || !family2) {
        return `${element1.elementName || "Undefined"} and ${element2.elementName || "Undefined"} cannot form a compound due to missing information.`;
    }

    // Allow diatomic molecules (e.g., H2, O2)
    if (element1.elementName === element2.elementName) {
        return null;  // Same element can always combine (e.g., H2)
    }

    // Check for specific incompatibilities first
    const familyCombination = `${family1} + ${family2}`;
    const reverseFamilyCombination = `${family2} + ${family1}`;

    // Check if this family combination is in the incompatible families list
    if (incompatibleFamilies[familyCombination] || incompatibleFamilies[reverseFamilyCombination]) {
        return incompatibleFamilies[familyCombination] || incompatibleFamilies[reverseFamilyCombination];
    }

    // Check the compatibility matrix for both directions (element1 with element2 and vice versa)
    const isFamily1CompatibleWithFamily2 = compatibilityMatrix[family1]?.includes(family2);
    const isFamily2CompatibleWithFamily1 = compatibilityMatrix[family2]?.includes(family1);

    // If either direction is compatible, allow the combination
    if (isFamily1CompatibleWithFamily2 || isFamily2CompatibleWithFamily1) {
        return null;  // Compatible
    }

    // If no match, return an incompatibility message
    return `${element1.elementName} and ${element2.elementName} cannot form a compound because they are incompatible based on their families (${family1} and ${family2}).`;
}




function formCompound() {
    const selectedIons = ions.filter(ion => document.getElementById(`compound-checkbox-${ion.id}`).checked);

    if (selectedIons.length < 2) {
        alert('Please select at least two ions to form a compound.');
        return;
    }

    // Loop through each pair of selected ions to check compatibility
    for (let i = 0; i < selectedIons.length - 1; i++) {
        for (let j = i + 1; j < selectedIons.length; j++) {
            const incompatibilityReason = checkCompatibility(selectedIons[i], selectedIons[j]);
            if (incompatibilityReason) {
                alert(incompatibilityReason); // Show why they are incompatible
                return;
            }
        }
    }

    // Proceed to form the compound if all elements are compatible
    let totalProtons = 0;
    let totalNeutrons = 0;
    let totalElectrons = 0;
    let netCharge = 0;

    selectedIons.forEach(ion => {
        totalProtons += ion.protons;
    totalNeutrons += ion.neutrons;
    totalElectrons += ion.electrons;
    netCharge += ion.charge;
});

const compoundName = selectedIons.map(ion => ion.elementName).join(' + ');
alert(`Success! The elements ${compoundName} can form a compound.`);

// Display and animate the compound
createCompoundVisualization(compoundName, totalProtons, totalNeutrons, totalElectrons, netCharge);
}


// Function to create the compound visualization
function createCompoundVisualization(compoundName, totalProtons, totalNeutrons, totalElectrons, netCharge) {
    // Create compound visualization container
    const compoundContainer = document.createElement('div');
    compoundContainer.className = 'ion-container';
    compoundContainer.innerHTML = `
<div>
            <h3>Compound: ${compoundName}</h3>
    <div id="compound-animation" class="ion-animation">
            <div class="nucleus"></div>
            </div>
            </div>
            <div>
            <div id="compound-info">
            <p>Total Protons: ${totalProtons}</p>
            <p>Total Neutrons: ${totalNeutrons}</p>
            <p>Total Electrons: ${totalElectrons}</p>
            <p>Net Charge: ${netCharge}</p>
            </div>
    </div>
    `;
    document.getElementById('ions-container').appendChild(compoundContainer);

    // Update the compound animation to visualize protons, neutrons, and electrons
    updateCompoundAnimation(compoundContainer, totalProtons, totalNeutrons, totalElectrons, netCharge);
}

function updateCompoundAnimation(compoundContainer, totalProtons, totalNeutrons, totalElectrons, netCharge) {
    const nucleus = compoundContainer.querySelector('.nucleus');
    nucleus.style.width = '150px';
    nucleus.style.height = '150px';
    nucleus.style.backgroundColor = netCharge === 0 ? 'yellow' : (netCharge > 0 ? 'orange' : 'purple');

    nucleus.innerHTML = ''; // Clear previous protons and neutrons

    // Distribute protons and neutrons randomly inside the nucleus
    const radius = 40; // Adjust for spacing within the nucleus
    for (let i = 0; i < totalProtons; i++) {
        const proton = document.createElement('div');
        proton.className = 'proton';
        const position = getRandomPositionInCircle(radius);
        proton.style.position = 'absolute';
        proton.style.top = `${position.y + radius}px`;
        proton.style.left = `${position.x + radius}px`;
        nucleus.appendChild(proton);
    }

    for (let i = 0; i < totalNeutrons; i++) {
        const neutron = document.createElement('div');
        neutron.className = 'neutron';
        const position = getRandomPositionInCircle(radius);
        neutron.style.position = 'absolute';
        neutron.style.top = `${position.y + radius}px`;
        neutron.style.left = `${position.x + radius}px`;
        nucleus.appendChild(neutron);
    }

    // Add electrons orbiting around the nucleus with 3D effect
    const animation = compoundContainer.querySelector('.ion-animation');
    animation.querySelectorAll('.electron').forEach(electron => electron.remove());

    const shellDistances = [70, 100, 130]; // Example shell distances for the compound
    const electronsPerShell = [2, 8, 18]; // Max electrons per shell
    let electronCount = totalElectrons;

    for (let shell = 0; shell < shellDistances.length && electronCount > 0; shell++) {
        const electronsInThisShell = Math.min(electronCount, electronsPerShell[shell]);

        for (let i = 0; i < electronsInThisShell; i++) {
            const electron = document.createElement('div');
            electron.className = 'electron';
            electron.style.setProperty('--orbit-radius', `${shellDistances[shell]}px`);
            electron.style.animation = `orbit3D ${Math.random() * 4 + 3}s linear infinite`;
            electron.style.animationDelay = `${Math.random()}s`;
            animation.appendChild(electron);
        }
        electronCount -= electronsInThisShell;
    }
}

// Helper function to get a random position inside a circle (for placing protons and neutrons)
function getRandomPositionInCircle(radius) {
    const angle = Math.random() * 2 * Math.PI;
    const distance = Math.sqrt(Math.random()) * radius; // Ensures uniform distribution
    const x = Math.cos(angle) * distance;
    const y = Math.sin(angle) * distance;
    return { x, y };
}



function updateCompoundAnimation(compoundContainer, totalProtons, totalNeutrons, totalElectrons, netCharge) {
    const nucleus = compoundContainer.querySelector('.nucleus');
    nucleus.style.backgroundColor = netCharge === 0 ? 'yellow' : (netCharge > 0 ? 'orange' : 'purple');

    nucleus.innerHTML = ''; // Clear previous protons and neutrons

    // Distribute protons and neutrons randomly inside the nucleus, same as the ion
    const totalParticles = totalProtons + totalNeutrons;
    const radius = 40; // Adjust for spacing within the nucleus

    for (let i = 0; i < totalProtons; i++) {
        const proton = document.createElement('div');
        proton.className = 'proton';
        const position = getRandomPositionInCircle(radius);
        proton.style.position = 'absolute';
        proton.style.top = `${position.y + radius}px`;
        proton.style.left = `${position.x + radius}px`;
        nucleus.appendChild(proton);
    }

    for (let i = 0; i < totalNeutrons; i++) {
        const neutron = document.createElement('div');
        neutron.className = 'neutron';
        const position = getRandomPositionInCircle(radius);
        neutron.style.position = 'absolute';
        neutron.style.top = `${position.y + radius}px`;
        neutron.style.left = `${position.x + radius}px`;
        nucleus.appendChild(neutron);
    }

    const animation = compoundContainer.querySelector('.ion-animation');
    animation.querySelectorAll('.electron').forEach(electron => electron.remove());

    // Add electrons orbiting around the nucleus with 3D effect, similar to individual ion
    const shellDistances = [70, 100, 130]; // Example shell distances for the compound
    let electronsPerShell = [2, 8, 18]; // Max electrons per shell
    let electronCount = totalElectrons;

    for (let shell = 0; shell < shellDistances.length && electronCount > 0; shell++) {
        const electronsInThisShell = Math.min(electronCount, electronsPerShell[shell]);

        for (let i = 0; i < electronsInThisShell; i++) {
            const electron = document.createElement('div');
            electron.className = 'electron';
            electron.style.setProperty('--orbit-radius', `${shellDistances[shell]}px`);
            electron.style.animation = `orbit3D ${Math.random() * 4 + 3}s linear infinite`;
            electron.style.animationDelay = `${Math.random()}s`;

            animation.appendChild(electron);
        }
        electronCount -= electronsInThisShell;
    }
}


const elements = [
    {symbol: 'H', name: 'Hydrogen', number: 1, protons: 1, neutrons: 0, family: 'Nonmetal'},
    {symbol: 'He', name: 'Helium', number: 2, protons: 2, neutrons: 2, family: 'Noble Gas'},
    {symbol: 'Li', name: 'Lithium', number: 3, protons: 3, neutrons: 4, family: 'Alkali Metal'},
    {symbol: 'Be', name: 'Beryllium', number: 4, protons: 4, neutrons: 5, family: 'Alkaline Earth Metal'},
    {symbol: 'B', name: 'Boron', number: 5, protons: 5, neutrons: 6, family: 'Metalloid'},
    {symbol: 'C', name: 'Carbon', number: 6, protons: 6, neutrons: 6, family: 'Nonmetal'},
    {symbol: 'N', name: 'Nitrogen', number: 7, protons: 7, neutrons: 7, family: 'Nonmetal'},
    {symbol: 'O', name: 'Oxygen', number: 8, protons: 8, neutrons: 8, family: 'Nonmetal'},
    {symbol: 'F', name: 'Fluorine', number: 9, protons: 9, neutrons: 10, family: 'Halogen'},
    {symbol: 'Ne', name: 'Neon', number: 10, protons: 10, neutrons: 10, family: 'Noble Gas'},
    {symbol: 'Na', name: 'Sodium', number: 11, protons: 11, neutrons: 12, family: 'Alkali Metal'},
    {symbol: 'Mg', name: 'Magnesium', number: 12, protons: 12, neutrons: 12, family: 'Alkaline Earth Metal'},
    {symbol: 'Al', name: 'Aluminum', number: 13, protons: 13, neutrons: 14, family: 'Post-Transition Metal'},
    {symbol: 'Si', name: 'Silicon', number: 14, protons: 14, neutrons: 14, family: 'Metalloid'},
    {symbol: 'P', name: 'Phosphorus', number: 15, protons: 15, neutrons: 16, family: 'Nonmetal'},
    {symbol: 'S', name: 'Sulfur', number: 16, protons: 16, neutrons: 16, family: 'Nonmetal'},
    {symbol: 'Cl', name: 'Chlorine', number: 17, protons: 17, neutrons: 18, family: 'Halogen'},
    {symbol: 'Ar', name: 'Argon', number: 18, protons: 18, neutrons: 22, family: 'Noble Gas'},
    {symbol: 'K', name: 'Potassium', number: 19, protons: 19, neutrons: 20, family: 'Alkali Metal'},
    {symbol: 'Ca', name: 'Calcium', number: 20, protons: 20, neutrons: 20, family: 'Alkaline Earth Metal'},
    {symbol: 'Sc', name: 'Scandium', number: 21, protons: 21, neutrons: 24, family: 'Transition Metal'},
    {symbol: 'Ti', name: 'Titanium', number: 22, protons: 22, neutrons: 26, family: 'Transition Metal'},
    {symbol: 'V', name: 'Vanadium', number: 23, protons: 23, neutrons: 28, family: 'Transition Metal'},
    {symbol: 'Cr', name: 'Chromium', number: 24, protons: 24, neutrons: 28, family: 'Transition Metal'},
    {symbol: 'Mn', name: 'Manganese', number: 25, protons: 25, neutrons: 30, family: 'Transition Metal'},
    {symbol: 'Fe', name: 'Iron', number: 26, protons: 26, neutrons: 30, family: 'Transition Metal'},
    {symbol: 'Co', name: 'Cobalt', number: 27, protons: 27, neutrons: 32, family: 'Transition Metal'},
    {symbol: 'Ni', name: 'Nickel', number: 28, protons: 28, neutrons: 31, family: 'Transition Metal'},
    {symbol: 'Cu', name: 'Copper', number: 29, protons: 29, neutrons: 35, family: 'Transition Metal'},
    {symbol: 'Zn', name: 'Zinc', number: 30, protons: 30, neutrons: 35, family: 'Transition Metal'},
    {symbol: 'Ga', name: 'Gallium', number: 31, protons: 31, neutrons: 39, family: 'Post-Transition Metal'},
    {symbol: 'Ge', name: 'Germanium', number: 32, protons: 32, neutrons: 41, family: 'Metalloid'},
    {symbol: 'As', name: 'Arsenic', number: 33, protons: 33, neutrons: 42, family: 'Metalloid'},
    {symbol: 'Se', name: 'Selenium', number: 34, protons: 34, neutrons: 45, family: 'Nonmetal'},
    {symbol: 'Br', name: 'Bromine', number: 35, protons: 35, neutrons: 45, family: 'Halogen'},
    {symbol: 'Kr', name: 'Krypton', number: 36, protons: 36, neutrons: 48, family: 'Noble Gas'},
    {symbol: 'Rb', name: 'Rubidium', number: 37, protons: 37, neutrons: 48, family: 'Alkali Metal'},
    {symbol: 'Sr', name: 'Strontium', number: 38, protons: 38, neutrons: 50, family: 'Alkaline Earth Metal'},
    {symbol: 'Y', name: 'Yttrium', number: 39, protons: 39, neutrons: 50, family: 'Transition Metal'},
    {symbol: 'Zr', name: 'Zirconium', number: 40, protons: 40, neutrons: 51, family: 'Transition Metal'},
    {symbol: 'Nb', name: 'Niobium', number: 41, protons: 41, neutrons: 52, family: 'Transition Metal'},
    {symbol: 'Mo', name: 'Molybdenum', number: 42, protons: 42, neutrons: 54, family: 'Transition Metal'},
    {symbol: 'Tc', name: 'Technetium', number: 43, protons: 43, neutrons: 55, family: 'Transition Metal'},
    {symbol: 'Ru', name: 'Ruthenium', number: 44, protons: 44, neutrons: 57, family: 'Transition Metal'},
    {symbol: 'Rh', name: 'Rhodium', number: 45, protons: 45, neutrons: 58, family: 'Transition Metal'},
    {symbol: 'Pd', name: 'Palladium', number: 46, protons: 46, neutrons: 60, family: 'Transition Metal'},
    {symbol: 'Ag', name: 'Silver', number: 47, protons: 47, neutrons: 61, family: 'Transition Metal'},
    {symbol: 'Cd', name: 'Cadmium', number: 48, protons: 48, neutrons: 64, family: 'Transition Metal'},
    {symbol: 'In', name: 'Indium', number: 49, protons: 49, neutrons: 66, family: 'Post-Transition Metal'},
    {symbol: 'Sn', name: 'Tin', number: 50, protons: 50, neutrons: 69, family: 'Post-Transition Metal'},
    {symbol: 'Sb', name: 'Antimony', number: 51, protons: 51, neutrons: 71, family: 'Metalloid'},
    {symbol: 'Te', name: 'Tellurium', number: 52, protons: 52, neutrons: 76, family: 'Metalloid'},
    {symbol: 'I', name: 'Iodine', number: 53, protons: 53, neutrons: 74, family: 'Halogen'},
    {symbol: 'Xe', name: 'Xenon', number: 54, protons: 54, neutrons: 77, family: 'Noble Gas'},
    {symbol: 'Cs', name: 'Cesium', number: 55, protons: 55, neutrons: 78, family: 'Alkali Metal'},
    {symbol: 'Ba', name: 'Barium', number: 56, protons: 56, neutrons: 81, family: 'Alkaline Earth Metal'},
    {symbol: 'La', name: 'Lanthanum', number: 57, protons: 57, neutrons: 82, family: 'Lanthanide'},
    {symbol: 'Ce', name: 'Cerium', number: 58, protons: 58, neutrons: 82, family: 'Lanthanide'},
    {symbol: 'Pr', name: 'Praseodymium', number: 59, protons: 59, neutrons: 82, family: 'Lanthanide'},
    {symbol: 'Nd', name: 'Neodymium', number: 60, protons: 60, neutrons: 84, family: 'Lanthanide'},
    {symbol: 'Pm', name: 'Promethium', number: 61, protons: 61, neutrons: 84, family: 'Lanthanide'},
    {symbol: 'Sm', name: 'Samarium', number: 62, protons: 62, neutrons: 88, family: 'Lanthanide'},
    {symbol: 'Eu', name: 'Europium', number: 63, protons: 63, neutrons: 89, family: 'Lanthanide'},
    {symbol: 'Gd', name: 'Gadolinium', number: 64, protons: 64, neutrons: 93, family: 'Lanthanide'},
    {symbol: 'Tb', name: 'Terbium', number: 65, protons: 65, neutrons: 94, family: 'Lanthanide'},
    {symbol: 'Dy', name: 'Dysprosium', number: 66, protons: 66, neutrons: 97, family: 'Lanthanide'},
    {symbol: 'Ho', name: 'Holmium', number: 67, protons: 67, neutrons: 98, family: 'Lanthanide'},
    {symbol: 'Er', name: 'Erbium', number: 68, protons: 68, neutrons: 99, family: 'Lanthanide'},
    {symbol: 'Tm', name: 'Thulium', number: 69, protons: 69, neutrons: 100, family: 'Lanthanide'},
    {symbol: 'Yb', name: 'Ytterbium', number: 70, protons: 70, neutrons: 103, family: 'Lanthanide'},
    {symbol: 'Lu', name: 'Lutetium', number: 71, protons: 71, neutrons: 104, family: 'Lanthanide'},
    {symbol: 'Hf', name: 'Hafnium', number: 72, protons: 72, neutrons: 106, family: 'Transition Metal'},
    {symbol: 'Ta', name: 'Tantalum', number: 73, protons: 73, neutrons: 108, family: 'Transition Metal'},
    {symbol: 'W', name: 'Tungsten', number: 74, protons: 74, neutrons: 110, family: 'Transition Metal'},
    {symbol: 'Re', name: 'Rhenium', number: 75, protons: 75, neutrons: 111, family: 'Transition Metal'},
    {symbol: 'Os', name: 'Osmium', number: 76, protons: 76, neutrons: 114, family: 'Transition Metal'},
    {symbol: 'Ir', name: 'Iridium', number: 77, protons: 77, neutrons: 115, family: 'Transition Metal'},
    {symbol: 'Pt', name: 'Platinum', number: 78, protons: 78, neutrons: 117, family: 'Transition Metal'},
    {symbol: 'Au', name: 'Gold', number: 79, protons: 79, neutrons: 118, family: 'Transition Metal'},
    {symbol: 'Hg', name: 'Mercury', number: 80, protons: 80, neutrons: 121, family: 'Transition Metal'},
    {symbol: 'Tl', name: 'Thallium', number: 81, protons: 81, neutrons: 123, family: 'Post-Transition Metal'},
    {symbol: 'Pb', name: 'Lead', number: 82, protons: 82, neutrons: 125, family: 'Post-Transition Metal'},
    {symbol: 'Bi', name: 'Bismuth', number: 83, protons: 83, neutrons: 126, family: 'Post-Transition Metal'},
    {symbol: 'Po', name: 'Polonium', number: 84, protons: 84, neutrons: 125, family: 'Metalloid'},
    {symbol: 'At', name: 'Astatine', number: 85, protons: 85, neutrons: 125, family: 'Halogen'},
    {symbol: 'Rn', name: 'Radon', number: 86, protons: 86, neutrons: 136, family: 'Noble Gas'},
    {symbol: 'Fr', name: 'Francium', number: 87, protons: 87, neutrons: 136, family: 'Alkali Metal'},
    {symbol: 'Ra', name: 'Radium', number: 88, protons: 88, neutrons: 138, family: 'Alkaline Earth Metal'},
    {symbol: 'Ac', name: 'Actinium', number: 89, protons: 89, neutrons: 138, family: 'Actinide'},
    {symbol: 'Th', name: 'Thorium', number: 90, protons: 90, neutrons: 142, family: 'Actinide'},
    {symbol: 'Pa', name: 'Protactinium', number: 91, protons: 91, neutrons: 140, family: 'Actinide'},
    {symbol: 'U', name: 'Uranium', number: 92, protons: 92, neutrons: 146, family: 'Actinide'},
    {symbol: 'Np', name: 'Neptunium', number: 93, protons: 93, neutrons: 144, family: 'Actinide'},
    {symbol: 'Pu', name: 'Plutonium', number: 94, protons: 94, neutrons: 150, family: 'Actinide'},
    {symbol: 'Am', name: 'Americium', number: 95, protons: 95, neutrons: 148, family: 'Actinide'},
    {symbol: 'Cm', name: 'Curium', number: 96, protons: 96, neutrons: 151, family: 'Actinide'},
    {symbol: 'Bk', name: 'Berkelium', number: 97, protons: 97, neutrons: 150, family: 'Actinide'},
    {symbol: 'Cf', name: 'Californium', number: 98, protons: 98, neutrons: 153, family: 'Actinide'},
    {symbol: 'Es', name: 'Einsteinium', number: 99, protons: 99, neutrons: 153, family: 'Actinide'},
    {symbol: 'Fm', name: 'Fermium', number: 100, protons: 100, neutrons: 157, family: 'Actinide'},
    {symbol: 'Md', name: 'Mendelevium', number: 101, protons: 101, neutrons: 157, family: 'Actinide'},
    {symbol: 'No', name: 'Nobelium', number: 102, protons: 102, neutrons: 157, family: 'Actinide'},
    {symbol: 'Lr', name: 'Lawrencium', number: 103, protons: 103, neutrons: 159, family: 'Actinide'},
    {symbol: 'Rf', name: 'Rutherfordium', number: 104, protons: 104, neutrons: 157, family: 'Transition Metal'},
    {symbol: 'Db', name: 'Dubnium', number: 105, protons: 105, neutrons: 157, family: 'Transition Metal'},
    {symbol: 'Sg', name: 'Seaborgium', number: 106, protons: 106, neutrons: 160, family: 'Transition Metal'},
    {symbol: 'Bh', name: 'Bohrium', number: 107, protons: 107, neutrons: 157, family: 'Transition Metal'},
    {symbol: 'Hs', name: 'Hassium', number: 108, protons: 108, neutrons: 169, family: 'Transition Metal'},
    {symbol: 'Mt', name: 'Meitnerium', number: 109, protons: 109, neutrons: 157, family: 'Unknown'},
    {symbol: 'Ds', name: 'Darmstadtium', number: 110, protons: 110, neutrons: 157, family: 'Unknown'},
    {symbol: 'Rg', name: 'Roentgenium', number: 111, protons: 111, neutrons: 157, family: 'Unknown'},
    {symbol: 'Cn', name: 'Copernicium', number: 112, protons: 112, neutrons: 173, family: 'Transition Metal'},
    {symbol: 'Nh', name: 'Nihonium', number: 113, protons: 113, neutrons: 173, family: 'Unknown'},
    {symbol: 'Fl', name: 'Flerovium', number: 114, protons: 114, neutrons: 175, family: 'Unknown'},
    {symbol: 'Mc', name: 'Moscovium', number: 115, protons: 115, neutrons: 175, family: 'Unknown'},
    {symbol: 'Lv', name: 'Livermorium', number: 116, protons: 116, neutrons: 177, family: 'Unknown'},
    {symbol: 'Ts', name: 'Tennessine', number: 117, protons: 117, neutrons: 177, family: 'Unknown'},
    {symbol: 'Og', name: 'Oganesson', number: 118, protons: 118, neutrons: 176, family: 'Unknown'}
];


function generatePeriodicTable() {
    const table = document.getElementById('periodic-table');
    elements.forEach(element => {
        const el = document.createElement('div');
    el.className = 'element';
    el.innerText = element.symbol;
    el.onclick = () => {
        const selectedRadio = document.querySelector('input[name="selected-ion"]:checked');
        if (selectedRadio) {
            selectedIonId = parseInt(selectedRadio.value);
            selectElementForIon(element);
        } else {
            alert('Please select an ion using the radio buttons.');
        }
    };
    table.appendChild(el);
});
}

function selectElementForIon(element) {
    if (selectedIonId === null) {
        alert('Please select an ion using the radio buttons.');
        return;
    }

    const ion = ions[selectedIonId];

    // Set the ion's element properties based on the selected element
    ion.elementName = element.name;
    ion.elementFamily = element.family;

    // Update protons and neutrons based on the selected element
    ion.protons = element.number;
    ion.neutrons = element.neutrons;

    // Recalculate electrons based on protons and charge
    ion.electrons = element.number + ion.charge; // Reset electrons to match protons then adjust by charge

    // Update quark structure for protons and neutrons
    ion.quarks.protons = Array(ion.protons).fill(['up', 'up', 'down']);  // Each proton has this quark structure
    ion.quarks.neutrons = Array(ion.neutrons).fill(['down', 'down', 'up']);  // Each neutron has this quark structure

    updateIonInfo(selectedIonId); // Ensure the UI is updated
    updateQuarkInfo(selectedIonId);  // Ensure the quark info is updated
}

</script>

</body>
</html>
